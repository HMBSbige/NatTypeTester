<UserControl
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:NatTypeTester.ViewModels;assembly=NatTypeTester.ViewModels"
    xmlns:designViewModels="clr-namespace:NatTypeTester.Views.DesignViewModels"
    xmlns:valueConverters="clr-namespace:NatTypeTester.Views.ValueConverters"
    xmlns:ic="using:FluentIcons.Avalonia"
    mc:Ignorable="d"
    d:DesignWidth="600" d:DesignHeight="500"
    x:Class="NatTypeTester.Views.Views.SettingsView"
    x:DataType="vm:SettingsViewModel">
    <Design.DataContext>
        <designViewModels:DesignSettingsViewModel />
    </Design.DataContext>

    <ScrollViewer>
        <StackPanel Margin="10" Spacing="20">
            <!-- Update Settings -->
            <StackPanel Spacing="10">
                <TextBlock x:Name="UpdateLabel" FontWeight="Bold" FontSize="16" />
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock x:Name="CurrentVersionLabel" VerticalAlignment="Center"
                               Text="{Binding CurrentVersionDisplay}" />
                    <TextBlock VerticalAlignment="Center"
                               Text="{Binding LatestVersionDisplay}"
                               IsVisible="{Binding LatestVersionDisplay, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <Button x:Name="CheckUpdateButton" Command="{Binding CheckUpdateCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                            <ic:FluentIcon Icon="ArrowSync" IconVariant="Regular" />
                            <TextBlock x:Name="CheckUpdateButtonText" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="OpenHomepageButton" Command="{Binding OpenHomepageCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="5">
                            <ic:FluentIcon Icon="Open" IconVariant="Regular" />
                            <TextBlock x:Name="OpenHomepageButtonText" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                </StackPanel>
                <CheckBox x:Name="AutoCheckUpdateCheckBox" IsChecked="{Binding AutoCheckUpdate}" />
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock x:Name="CheckUpdateIntervalLabel" VerticalAlignment="Center" />
                    <NumericUpDown Value="{Binding CheckUpdateIntervalHours}" Minimum="0.1" Maximum="720"
                                   Increment="1" FormatString="0.#" Width="120" />
                </StackPanel>
                <CheckBox x:Name="IncludePreReleaseCheckBox" IsChecked="{Binding IncludePreRelease}" />
            </StackPanel>

            <!-- Proxy Settings -->
            <StackPanel Spacing="10">
                <TextBlock x:Name="ProxyLabel" FontWeight="Bold" FontSize="16" />
                <StackPanel Orientation="Horizontal" Spacing="20">
                    <RadioButton x:Name="NoProxyRadioButton" GroupName="ProxyType"
                                 IsChecked="{Binding ProxyType, Converter={x:Static valueConverters:ProxyTypeConverters.PlainConverter}}" />
                    <RadioButton x:Name="Socks5ProxyRadioButton" GroupName="ProxyType"
                                 IsChecked="{Binding ProxyType, Converter={x:Static valueConverters:ProxyTypeConverters.Socks5Converter}}" />
                </StackPanel>

                <!-- Proxy Config Grid -->
                <StackPanel IsVisible="{Binding ProxyType, Converter={x:Static valueConverters:ProxyTypeConverters.IsSocks5Converter}}" Spacing="10">
                    <StackPanel>
                        <TextBlock x:Name="ProxyServerLabel" Margin="0,0,0,5" />
                        <TextBox Text="{Binding ProxyServer}" />
                    </StackPanel>
                    <StackPanel>
                        <TextBlock x:Name="ProxyUsernameLabel" Margin="0,0,0,5" />
                        <TextBox Text="{Binding ProxyUser}" />
                    </StackPanel>
                    <StackPanel>
                        <TextBlock x:Name="ProxyPasswordLabel" Margin="0,0,0,5" />
                        <TextBox Text="{Binding ProxyPassword}" PasswordChar="â€¢" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>

            <!-- Language Settings -->
            <StackPanel Spacing="10">
                <TextBlock x:Name="LanguageLabel" FontWeight="Bold" FontSize="16" />
                <ComboBox ItemsSource="{Binding Languages}"
                          SelectedItem="{Binding SelectedLanguage}"
                          DisplayMemberBinding="{Binding DisplayName}"
                          MinWidth="150" />
            </StackPanel>

            <!-- STUN Server List Source -->
            <StackPanel Spacing="10">
                <TextBlock x:Name="StunServerListLabel" FontWeight="Bold" FontSize="16" />
                <Grid ColumnDefinitions="*,Auto">
                    <TextBox Grid.Column="0" Text="{Binding StunServerListUri}" />
                    <Button x:Name="LoadStunServerListButton" Grid.Column="1"
                            Command="{Binding LoadStunServerListCommand}" Margin="5,0,0,0">
                        <ic:FluentIcon Icon="ArrowDownload" IconVariant="Regular" />
                    </Button>
                </Grid>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>

</UserControl>
